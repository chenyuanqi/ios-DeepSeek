# DeepSeek AI 聊天应用

这是一个仿 DeepSeek AI 官方应用的聊天界面实现，使用 SwiftUI 开发，并集成了 DeepSeek AI API。

## 功能特性

1. **聊天功能**
   - 用户可以输入消息并获得实时 AI 回复
   - 支持消息气泡展示，区分用户和 AI 消息
   - 支持默认提示问题的快速发送
   - 集成 DeepSeek API 提供真实的 AI 回复
   - **流式响应**：AI回复像打字一样逐步显示，带有打字光标动画

2. **聊天历史记录**
   - 自动保存对话历史
   - 按日期分组展示历史对话
   - 支持对话查询和删除

3. **用户界面**
   - 符合 iOS 设计规范的用户界面
   - 加载状态和错误处理
   - 流畅的动画和交互效果
   - 支持自适应布局

## 项目结构

项目采用 MVVM 架构模式组织代码：

- **Views**: 包含所有视图组件
  - `ChatView.swift`: 主聊天界面
  - `ChatHistoryView.swift`: 聊天历史记录界面
  - 其他自定义组件

- **ViewModels**: 包含业务逻辑
  - `ChatViewModel.swift`: 管理聊天和历史记录

- **Models**: 包含数据模型
  - `Message.swift`: 定义消息和对话数据结构

- **Services**: 包含服务层
  - `APIService.swift`: 处理与 DeepSeek API 的通信，支持标准请求和流式请求

## API 集成

应用集成了 DeepSeek API，通过 API 来获取 AI 回复：

- 使用 Combine 框架处理异步网络请求
- 实现错误处理和加载状态显示
- 支持多轮对话
- **流式响应**：使用自定义 Publisher 和 Subscription 实现逐字显示效果

## 流式响应实现

应用通过以下方式实现流式响应：

1. **自定义 Publisher**：创建 StreamPublisher 处理流式数据
2. **实时更新**：将接收到的每个文本片段实时添加到消息中
3. **打字光标**：使用动画实现闪烁的打字光标效果
4. **平滑滚动**：在接收新内容时自动滚动到最新位置

## 使用方法

1. **发送消息**
   - 在底部输入框中输入内容并点击发送按钮
   - 或点击预设问题直接发送
   - 享受 AI 回复的打字机效果

2. **查看历史记录**
   - 点击左上角菜单按钮打开历史记录
   - 可搜索或按时间查看历史对话

## 未来改进计划

1. ~~添加流式响应支持（Stream API）~~ **已实现**
2. 添加语音输入功能
3. 支持图片和文件的发送和接收
4. 增强对话记忆能力
5. 优化性能和用户体验 